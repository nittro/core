var _context=function(){var api,undefined,t={},loaded=[],loading={},indexOf=Array.prototype.indexOf,REQ_TIMEOUT=3e4,doc=document,loc=doc.location,elem=function(n){return doc.createElement(n)},win=window,setTimeout=function(c,t){return win.setTimeout(c,t)},clearTimeout=function(t){return win.clearTimeout(t)},promise=Promise;"function"!=typeof indexOf&&(indexOf=function(e){for(var i=0;i<this.length;i++)if(this[i]===e)return i;return-1});var resolver=null,resolveUrl=function(u){return resolver||(resolver=elem("a")),resolver.href=u,resolver.href},isRelative=function(u){try{var len=/^https?:\/\/.+?(\/|$)/i.exec(loc.href)[0].length;return u.substr(0,len)===loc.href.substr(0,len)}catch(err){return!1}},xhrFactory=function(o,f){for(;o.length;)try{return f=o.shift(),f(),f}catch(e){}return function(){throw new Error}}([function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}]),xdrFactory=function(){try{if("withCredentials"in new XMLHttpRequest)return function(){return new XMLHttpRequest};if(win.XDomainRequest!==undefined)return function(){return new win.XDomainRequest}}catch(err){}return function(){throw new Error}}(),xhr=function(u){return new promise(function(fulfill,reject){var req,m;req=isRelative(u)?xhrFactory():xdrFactory(),req.open("GET",u,!0);var f=function(){m&&clearTimeout(m),fulfill(req)},r=function(){m&&clearTimeout(m),reject(req)};"onsuccess"in req?(req.onsuccess=f,req.onerror=r):win.XDomainRequest!==undefined&&req instanceof win.XDomainRequest?(req.onload=f,req.onerror=r):req.onreadystatechange=function(){4===req.readyState&&(200===req.status?f():r())},req.send(),m=setTimeout(function(){if(req.readyState&&req.readyState<4)try{req.abort()}catch(err){}m=null,r()},REQ_TIMEOUT)})},exec=function(s,t,u){var e;t=t?t.replace(/\s*;.*$/,"").toLowerCase():u.match(/\.(?:less|css)/i)?"text/css":"text/javascript","text/css"===t?(e=elem("style"),e.type=t,u=u.replace(/[^\/]+$/,""),s=s.replace(/url\s*\(('|")?(?:\.\/)?(.+?)\1\)/,function(m,q,n){return q||(q='"'),n.match(/^(?:(?:https?:)?\/)?\//)?"url("+q+n+q+")":"url("+q+resolveUrl(u+n)+q+")"}),e.styleSheet?e.styleSheet.cssText=s:e.appendChild(doc.createTextNode(s)),doc.head.appendChild(e)):(e=elem("script"),e.type="text/javascript",e.text=s,doc.head.appendChild(e).parentNode.removeChild(e))},map={names:[],classes:[]},lookup=function(s,c){var i=map.names.indexOf(s);if(i>-1)return map.classes[i];for(var n,r=t,p=s.split(".");p.length;){if(n=p.shift(),r[n]===undefined){if(!c)throw new Error(s+" not found in context");r[n]={}}r=r[n]}return map.names.push(s),map.classes.push(r),r},lookupClass=function(o){if("object"==typeof o&&o.constructor!==Object&&(o=o.constructor),"function"!=typeof o&&"object"!=typeof o)throw new Error("Cannot lookup class name of non-object");var i=map.classes.indexOf(o);return-1===i?!1:map.names[i]},load=function(){var u,a,p=promise.resolve(!0);for(a=0;a<arguments.length;a++)"function"==typeof arguments[a]?p=p.then(function(f){return function(){return invoke(f)}}(arguments[a])):"string"==typeof arguments[a]&&(u=resolveUrl(arguments[a]),-1===indexOf.call(loaded,u)&&(p=loading[u]?p.then(function(p){return function(){return p}}(loading[u])):loading[u]=function(p,u){return new promise(function(f,r){xhr(u).then(function(xhr){p.then(function(){exec(xhr.responseText,xhr.getResponseHeader("Content-Type"),u),delete loading[u],loaded.push(u),f()},r)})})}(p,u)));return a={then:function(fulfilled,rejected){return p.then(function(){fulfilled&&invoke(fulfilled)},function(){rejected&&invoke(rejected)}),a}}},nsStack=[],invoke=function(ns,f,i){i===undefined&&"function"==typeof ns&&(i=f,f=ns,ns=null),ns?nsStack.unshift(ns,ns=lookup(ns,!0)):(ns=t,nsStack.unshift(null,ns));var p,c,r,params=f.length?f.toString().match(/^function\s*\((.*?)\)/i)[1].split(/\s*,\s*/):[],args=[];for(p=0;p<params.length;p++)if("context"===params[p])args.push(api);else if("_NS_"===params[p])args.push(ns);else if("undefined"===params[p])args.push(undefined);else if(i!==undefined&&params[p]in i)c=i[params[p]],"string"==typeof c&&(c=lookup(c)),args.push(c);else if(ns[params[p]]!==undefined)args.push(ns[params[p]]);else{if(t[params[p]]===undefined)throw new Error('"'+params[p]+'" not found in context');args.push(t[params[p]])}return r=f.apply(ns,args),nsStack.shift(),nsStack.shift(),r},register=function(constructor,name){var ns=name.split(/\./g),key=ns.pop();return ns.length?ns=lookup(ns.join("."),!0):nsStack.length&&null!==nsStack[0]?(name=nsStack[0]+"."+name,ns=nsStack[1]):ns=t,ns[key]=constructor,map.names.push(name),map.classes.push(constructor),api},__ns=function(){arguments.length?nsStack.unshift(arguments[0],arguments[1]):(nsStack.shift(),nsStack.shift())},extend=function(parent,constructor,proto){proto||(proto=constructor,constructor=parent,parent=null),parent?"string"==typeof parent&&(parent=lookup(parent)):parent=Object;var tmp=function(){};return tmp.prototype=parent.prototype,constructor.prototype=new tmp,constructor.prototype.constructor=constructor,constructor.Super=parent,proto&&(proto.hasOwnProperty("STATIC")&&proto.STATIC&&copyProps(constructor,proto.STATIC),copyProps(constructor.prototype,proto)),constructor},mixin=function(target,source,map){return"string"==typeof source&&(source=lookup(source)),copyProps(target.prototype,source,map),target},copyProps=function(target,source,map){var key;for(key in source)source.hasOwnProperty(key)&&"STATIC"!==key&&(target[map&&key in map?map[key]:key]=source[key])};return api={lookup:lookup,lookupClass:lookupClass,invoke:invoke,load:load,extend:extend,mixin:mixin,register:register,__ns:__ns}}();_context.invoke("Utils",function(undefined){var Strings={applyModifiers:function(s){for(var a,m,f=Array.prototype.slice.call(arguments,1),i=0;i<f.length;i++)a=f[i].split(":"),m=a.shift(),a.unshift(s),s=Strings[m].apply(Strings,a);return s},toString:function(s){return s===undefined?"undefined":"string"==typeof s?s:s.toString!==undefined?s.toString():Object.prototype.toString.call(s)},sprintf:function(s){return Strings.vsprintf(s,Array.prototype.slice.call(arguments,1))},vsprintf:function(s,args){var n=0;return s.replace(/%(?:(\d+)\$)?(\.\d+|\[.*?:.*?\])?([idsfa%])/g,function(m,a,p,f){if("%"===f)return f;if(a=a?parseInt(a)-1:n++,args[a]===undefined)throw new Error("Missing parameter #"+(a+1));switch(a=args[a],f){case"s":return Strings.toString(a);case"i":case"d":return parseInt(a);case"f":return a=parseFloat(a),p&&p.match(/^\.\d+$/)&&(a=a.toFixed(parseInt(p.substr(1)))),a;case"a":return p=p&&p.match(/^\[.*:.*\]$/)?p.substr(1,p.length-2).split(":"):[", ",", "],0===a.length?"":a.slice(0,-1).join(p[0])+(a.length>1?p[1]:"")+a[a.length-1]}return m})},webalize:function(s,chars,ws){return ws&&(s=s.replace(/\s+/g,"_")),s=s.replace(new RegExp("[^_A-Za-zÀ-ſ"+Strings.escapeRegex(chars||"").replace(/\\-/g,"-")+"]+","g"),"-"),Strings.trim(s,"_-")},escapeRegex:function(s){return s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},split:function(s,re,offsetCapture,noEmpty,delimCapture){re=re instanceof RegExp?new RegExp(re.source,[re.ignoreCase?"i":"",re.multiline?"m":"","g"].filter(function(v){return!!v}).join("")):new RegExp(re,"g");var r=[],len=0;return s=s.replace(re,function(m,p,ofs){return ofs=arguments[arguments.length-2],p=s.substring(len,ofs),(p.length&&!p.match(/^[\t ]+$/)||!noEmpty)&&r.push(offsetCapture?[p,len]:s.substring(len,ofs)),delimCapture&&(m.length&&!m.match(/^[\t ]+$/)||!noEmpty)&&r.push(offsetCapture?[m,ofs]:m),len=ofs+m.length,m}),(len<s.length||!noEmpty)&&(s=s.substring(len),(!noEmpty||s.length&&!s.match(/^[\t ]+$/))&&r.push(offsetCapture?[s,len]:s)),r},trim:function(s,c){return Strings._trim(s,c,!0,!0)},trimLeft:function(s,c){return Strings._trim(s,c,!0,!1)},trimRight:function(s,c){return Strings._trim(s,c,!1,!0)},_trim:function(s,c,l,r){c||(c=" 	\n\r\x00\x0BÂ ");var re=[];return c="["+Strings.escapeRegex(c)+"]+",l&&re.push("^",c),l&&r&&re.push("|"),r&&re.push(c,"$"),s.replace(new RegExp(re.join(""),"ig"),"")},firstUpper:function(s){return s.substr(0,1).toUpperCase()+s.substr(1)},compare:function(a,b,len){return"string"!=typeof a||"string"!=typeof b?!1:(len||(len=Math.min(a.length,b.length)),a.substr(0,len).toLowerCase()===b.substr(0,len).toLowerCase())},contains:function(h,n){return-1!==h.indexOf(n)},isNumeric:function(s){return"[object Array]"!==Object.prototype.toString.call(s)&&s-parseFloat(s)+1>=0},escapeHtml:function(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},nl2br:function(s,collapse){return s.replace(collapse?/\n+/g:/\n/g,"<br />")},random:function(len,chars){chars=(chars||"a-z0-9").replace(/.-./g,function(m,a,b){a=m.charCodeAt(0),b=m.charCodeAt(2);for(var n=Math.abs(b-a),c=new Array(n),o=Math.min(a,b),i=0;n>=i;i++)c[i]=o+i;return String.fromCharCode.apply(null,c)}),len||(len=8);var i,s=new Array(len),n=chars.length-1;for(i=0;len>i;i++)s[i]=chars[Math.round(Math.random()*n)];return s.join("")}};_context.register(Strings,"Strings")}),_context.invoke("Utils",function(undefined){var Arrays={isArray:function(a){return a&&a.constructor===Array},isArrayLike:function(a){return"object"==typeof a&&a.length!==undefined},shuffle:function(a){for(var t,i,c=a.length;c--;)i=Math.random()*c|0,t=a[c],a[c]=a[i],a[i]=t;return a},createFrom:function(a,s,e){if(a.length===undefined)throw new Error("Invalid argument, only array-like objects can be supplied");return Array.prototype.slice.call(a,s||0,e||a.length)},getKeys:function(a){var k,keys=[];if(Arrays.isArray(a))for(k=0;k<a.length;k++)keys.push(k);else for(k in a)keys.push(k);return keys},filterKeys:function(){var a,i,rem,args=Arrays.createFrom(arguments),t=args.shift(),r={};for(rem=function(k){r[k]===undefined&&(r[k]=t[k],delete t[k])};args.length;)if(a=args.shift(),"object"==typeof a)if(a instanceof Array)for(i=0;i<a.length;i++)rem(a[i]);else for(i in a)rem(i);else rem(a)},getValues:function(a){var k,arr=[];for(k in a)arr.push(a[k]);return arr},merge:function(){var b,i,args=Arrays.createFrom(arguments),a=args.shift(),r=!1;for("boolean"==typeof a&&(r=a,a=args.shift()),a||(a=[]);args.length;)if(b=args.shift(),b instanceof Array)for(i=0;i<b.length;i++)r&&"object"==typeof b[i]&&"[object Object]"===Object.prototype.toString.call(b[i])?a.push(Arrays.mergeTree(r,{},b[i])):a.push(b[i]);return a},mergeTree:function(){var r=!1,args=Arrays.createFrom(arguments),ofs=1,t=args.shift(),props=[];for("boolean"==typeof t&&(r=t,t=args.shift(),ofs=2);args.length;){var p,a,i,o=args.pop();if("object"==typeof o&&null!==o){t||(t={});for(p in o)if(o.hasOwnProperty(p)&&-1===props.indexOf(p)){if("object"==typeof o[p])if(r)if(o[p]instanceof Array){for(a=[r,t[p]||null],i=ofs;i<arguments.length;i++)a.push(arguments[i][p]||null);t[p]=Arrays.merge.apply(this,a)}else{for(a=[r,null],i=ofs;i<arguments.length;i++)a.push(arguments[i]?arguments[i][p]||null:null);t[p]=Arrays.mergeTree.apply(this,a)||t[p]}else t[p]=t[p]===undefined?o[p]:null===o[p]?t[p]:o[p];else t[p]=o[p];props.push(p)}}}return t},walk:function(r,a,f){"boolean"!=typeof r&&(f=a,a=r,r=!1);var i,p=function(k,v){r&&(v instanceof Array||v instanceof Object)?Arrays.walk(r,v,f):f.call(v,k,v)};if(a instanceof Array)for(i=0;i<a.length;i++)p(i,a[i]);else if(a instanceof Object)for(i in a)p(i,a[i]);else p(null,a)}};_context.register(Arrays,"Arrays")}),_context.invoke("Utils",function(Arrays,undefined){var HashMap=_context.extend(function(src){this._={keys:[],values:[],nonNumeric:0,nextNumeric:0},src&&this.merge(src)},{STATIC:{from:function(data,keys){if(!keys)return data instanceof HashMap?data.clone():new HashMap(data);if(!Arrays.isArray(keys))throw new Error("Invalid argument supplied to HashMap.from(): the second argument must be an array");var i,k,map=new HashMap,n=keys.length,arr=Arrays.isArray(data);for(i=0;n>i;i++)k=arr?i:keys[i],data[k]!==undefined&&map.set(keys[i],data[k]);return map}},length:0,isList:function(){return 0===this._.nonNumeric},clone:function(deep){var o=new HashMap;return o._.keys=this._.keys.slice(),o._.nextNumeric=this._.nextNumeric,o.length=this.length,deep?o._.values=this._.values.map(function(v){return v instanceof HashMap?v.clone(deep):v}):o._.values=this._.values.slice(),o},merge:function(src){if(src instanceof HashMap||Arrays.isArray(src))src.forEach(function(value,key){this.set(key,value)},this);else{if("object"!=typeof src||null===src)throw new TypeError("HashMap.merge() expects the first argument to be an array or an object, "+typeof src+" given");for(var k in src)src.hasOwnProperty(k)&&this.set(k,src[k])}return this},append:function(src){return src instanceof HashMap||Arrays.isArray(src)?src.forEach(function(value,key){"number"==typeof key?this.push(value):this.set(key,value)},this):this.merge(src),this},push:function(value){for(var i=0;i<arguments.length;i++)this._.keys.push(this._.nextNumeric),this._.values.push(arguments[i]),this._.nextNumeric++,this.length++;return this},pop:function(){if(!this.length)return null;var k=this._.keys.pop();return"number"==typeof k?k+1===this._.nextNumeric&&this._.nextNumeric--:this._.nonNumeric--,this.length--,this._.values.pop()},shift:function(){return this.length?("number"==typeof this._.keys[0]?(this._.nextNumeric--,this._shiftKeys(1,this.length,-1)):this._.nonNumeric--,this.length--,this._.keys.shift(),this._.values.shift()):null},unshift:function(value){for(var values=Arrays.createFrom(arguments),n=values.length,i=0,keys=new Array(n);n>i;)keys[i]=i++;return keys.unshift(0,0),values.unshift(0,0),this._shiftKeys(0,this.length,n),this._.keys.splice.apply(this._.keys,keys),this._.values.splice.apply(this._.values,values),this._.nextNumeric+=n,this.length+=n,this},slice:function(from,to){from===undefined&&(from=0),0>from&&(from+=this.length),to===undefined&&(to=this.length),0>to&&(to+=this.length);var o=new HashMap;return o._.keys=this._.keys.slice(from,to).map(function(k){return"number"==typeof k?(k=o._.nextNumeric,o._.nextNumeric++,k):(o._.nonNumeric++,k)}),o._.values=this._.values.slice(from,to),o.length=o._.keys.length,o},splice:function(from,remove){var removed,i,values=Arrays.createFrom(arguments),keys=values.slice().map(function(){return-1});for(keys[0]=values[0],keys[1]=values[1],this._.keys.splice.apply(this._.keys,keys),removed=this._.values.splice.apply(this._.values,values),this.length=this._.keys.length,this._.nextNumeric=0,this._.nonNumeric=0,i=0;i<this.length;i++)"number"==typeof this._.keys[i]?(this._.keys[i]=this._.nextNumeric,this._.nextNumeric++):this._.nonNumeric++;return removed},set:function(key,value){var i=this._.keys.indexOf(key);return-1===i?(this._.keys.push(key),this._.values.push(value),this.length++,"number"==typeof key?key>=this._.nextNumeric&&(this._.nextNumeric=key+1):this._.nonNumeric++):this._.values[i]=value,this},get:function(key,need){var i=this._.keys.indexOf(key);if(i>-1)return this._.values[i];if(need)throw new RangeError("Key "+key+" not present in HashMap");return null},has:function(key){var index=this._.keys.indexOf(key);return index>-1&&this._.values[index]!==undefined},forEach:function(callback,thisArg){for(var i=0;i<this.length;i++)callback.call(thisArg||null,this._.values[i],this._.keys[i],this);return this},map:function(callback,recursive,thisArg){return this.clone(recursive).walk(callback,recursive,thisArg)},walk:function(callback,recursive,thisArg){for(var i=0;i<this.length;i++)recursive&&this._.values[i]instanceof HashMap?this._.values[i].walk(callback,recursive,thisArg):this._.values[i]=callback.call(thisArg||null,this._.values[i],this._.keys[i],this);return this},find:function(predicate,thisArg){var i=this._find(predicate,thisArg,!0);return i===!1?null:this._.values[i]},findKey:function(predicate,thisArg){var i=this._find(predicate,thisArg,!0);return i===!1?null:this._.keys[i]},some:function(predicate,thisArg){return this._find(predicate,thisArg,!0)!==!1},all:function(predicate,thisArg){return this._find(predicate,thisArg,!1)===!1},filter:function(predicate,thisArg){var i,o=new HashMap;for(i=0;i<this.length;i++)predicate.call(thisArg||null,this._.values[i],this._.keys[i],this)&&("number"==typeof this._.keys[i]?o.push(this._.values[i]):o.set(this._.keys[i],this._.values[i]));return o},exportData:function(){if(this.isList())return this.getValues().map(function(v){return v instanceof HashMap?v.exportData():v});for(var i=0,r={};i<this.length;i++)this._.values[i]instanceof HashMap?r[this._.keys[i]]=this._.values[i].exportData():r[this._.keys[i]]=this._.values[i];return r},getKeys:function(){return this._.keys.slice()},getValues:function(){return this._.values.slice()},_shiftKeys:function(from,to,diff){for(;to>from;)"number"==typeof this._.keys[from]&&(this._.keys[from]+=diff),from++},_find:function(predicate,thisArg,expect){for(var i=0;i<this.length;i++)if(predicate.call(thisArg||null,this._.values[i],this._.keys[i],this)===expect)return i;return!1}});_context.register(HashMap,"HashMap")}),_context.invoke("Utils",function(Strings,undefined){var Url=function(s){var cur=document.location.href.match(Url.PARSER_REGEXP),src=null===s||""===s||s===undefined?cur:s.match(Url.PARSER_REGEXP),noHost=!src[4],path=src[6]||"";noHost&&"/"!==path.charAt(0)&&(path=path.length?Url.getDirName(cur[6]||"")+"/"+path.replace(/^\.\//,""):cur[6]),this._={protocol:src[1]||cur[1]||"",username:(noHost?src[2]||cur[2]:src[2])||"",password:(noHost?src[3]||cur[3]:src[3])||"",hostname:src[4]||cur[4]||"",port:(noHost?src[5]||cur[5]:src[5])||"",path:path,params:Url.parseQuery((noHost&&!src[6]?src[7]||cur[7]:src[7])||""),hash:(!noHost||src[6]||src[7]?src[8]:src[8]||cur[8])||""}};Url.prototype.getProtocol=function(){return this._.protocol},Url.prototype.getUsername=function(){return this._.username},Url.prototype.getPassword=function(){return this._.password},Url.prototype.getHostname=function(){return this._.hostname},Url.prototype.getPort=function(){return this._.port},Url.prototype.getAuthority=function(){var a="";return this._.username&&(a+=this._.password?this._.username+":"+this._.password+"@":this._.username+"@"),a+=this._.hostname,this._.port&&(a+=":"+this._.port),a},Url.prototype.getPath=function(){return this._.path},Url.prototype.getQuery=function(){var q=Url.buildQuery(this._.params);return q.length?"?"+q:""},Url.prototype.getParam=function(n){return this._.params[n]},Url.prototype.hasParam=function(n){return this._.params[n]!==undefined},Url.prototype.getParams=function(){return this._.params},Url.prototype.getHash=function(){return this._.hash},Url.prototype.setProtocol=function(protocol){return this._.protocol=protocol?Strings.trimRight(protocol,":")+":":"",this},Url.prototype.setUsername=function(username){return this._.username=username,this},Url.prototype.setPassword=function(password){return this._.password=password,this},Url.prototype.setHostname=function(hostname){return this._.hostname=hostname,this},Url.prototype.setPort=function(port){return this._.port=port,this},Url.prototype.setPath=function(path){return this._.path=path?"/"+Strings.trimLeft(path,"/"):"",this},Url.prototype.setQuery=function(query){return this._.params=Url.parseQuery(query),this},Url.prototype.setParam=function(n,v){return this._.params[n]=v,this},Url.prototype.addParams=function(p){if(p instanceof Array&&(p.length<1||"name"in p[0]))for(var i=0;i<p.length;i++)this._.params[p[i].name]=p[i].value;else for(var k in p)p[k]!==undefined&&(this._.params[k]=p[k]);return this},Url.prototype.getParams=function(){return this._.params},Url.prototype.setParams=function(p){return this._.params={},this.addParams(p),this},Url.prototype.removeParam=function(n){return delete this._.params[n],this},Url.prototype.setHash=function(hash){return this._.hash=hash?"#"+Strings.trimLeft(hash,"#"):"",this},Url.prototype.toAbsolute=function(){return this._.protocol+"//"+this.getAuthority()+this._.path+this.getQuery()+this._.hash},Url.prototype.toLocal=function(){return this._.path+this.getQuery()+this._.hash},Url.prototype.toRelative=function(to){if(to=Url.from(to||document.location.href),to.getProtocol()!==this.getProtocol())return this.toAbsolute();if(to.getAuthority()!==this.getAuthority())return"//"+this.getAuthority()+this.getPath()+this.getQuery()+this.getHash();if(to.getPath()!==this.getPath())return Url.getRelativePath(to.getPath(),this.getPath())+this.getQuery()+this.getHash();var qto=to.getQuery(),qthis=this.getQuery();return qto!==qthis?qthis+this.getHash():to.getHash()===this.getHash()?"":this.getHash()},Url.prototype.toString=function(){return this.toAbsolute()},Url.prototype.isLocal=function(){return this.compare(Url.fromCurrent())<Url.PART.PORT},Url.prototype.compare=function(to){to instanceof Url||(to=Url.from(to));var r=0;return this.getProtocol()!==to.getProtocol()&&(r|=Url.PART.PROTOCOL),this.getUsername()!==to.getUsername()&&(r|=Url.PART.USERNAME),this.getPassword()!==to.getPassword()&&(r|=Url.PART.PASSWORD),this.getHostname()!==to.getHostname()&&(r|=Url.PART.HOSTNAME),this.getPort()!==to.getPort()&&(r|=Url.PART.PORT),this.getPath()!==to.getPath()&&(r|=Url.PART.PATH),this.getQuery()!==to.getQuery()&&(r|=Url.PART.QUERY),this.getHash()!==to.getHash()&&(r|=Url.PART.HASH),r},Url.PARSER_REGEXP=/^(?:([^:/]+:)?\/\/(?:([^\/@]+?)(?::([^\/@]+))?@)?(?:([^/]+?)(?::(\d+))?(?=\/|$))?)?(.*?)(\?.*?)?(#.*)?$/,Url.PART={PROTOCOL:128,USERNAME:64,PASSWORD:32,HOSTNAME:16,PORT:8,PATH:4,QUERY:2,HASH:1},Url.from=function(s){return new Url(s instanceof Url?s.toAbsolute():"string"==typeof s||null===s||s===undefined?s:Strings.toString(s))},Url.fromCurrent=function(){return new Url},Url.getDirName=function(path){return path.replace(/(^|\/)[^\/]*$/,"")},Url.getRelativePath=function(from,to){if(from=Strings.trimLeft(from,"/").split("/"),from.pop(),!to.match(/^\//))return to.replace(/^\.\//,"");to=Strings.trimLeft(to,"/").split("/");for(var f,t,e=0,o=[],n=Math.min(from.length,to.length);n>e&&from[e]===to[e];e++);for(f=e;f<from.length;f++)o.push("..");for(t=e;t<to.length;t++)o.push(to[t]);return o.join("/")},Url.buildQuery=function(data,pairs){var n,q=[],en=encodeURIComponent,val=function(v){return v===undefined?null:"boolean"==typeof v?v?1:0:en(""+v)},flatten=function(a,n){var i,r=[];if(Array.isArray(a))for(i=0;i<a.length;i++)r.push(en(n+"[]")+"="+val(a[i]));else for(i in a)"object"==typeof a[i]?r.push(flatten(a[i],n+"["+i+"]")):r.push(en(n+"["+i+"]")+"="+val(a[i]));return r.filter(function(v){return null!==v}).join("&")};for(n in data)null!==data[n]&&data[n]!==undefined&&(pairs?q.push(en(data[n].name)+"="+val(data[n].value)):"object"==typeof data[n]?q.push(flatten(data[n],n)):q.push(en(n)+"="+val(data[n])));return q.filter(function(v){return null!==v}).join("&")},Url.parseQuery=function(s){if(s.match(/^\??$/))return{};s=Strings.trimLeft(s,"?").split("&");var c,d,k,i,m,n,v,p={},a=!1,convertType=function(v){return v.match(/^\d+$/)?parseInt(v):v.match(/^\d*\.\d+$/)?parseFloat(v):v};for(i=0;i<s.length;i++)if(m=s[i].split("="),n=decodeURIComponent(m.shift()),v=convertType(decodeURIComponent(m.join("="))),-1!==n.indexOf("[")){for(n=n.replace(/\]/g,""),d=n.split("["),c=p,a=!1,n.match(/\[$/)&&(d.pop(),a=!0),n=d.pop();d.length;)k=d.shift(),c[k]===undefined&&(c[k]={}),c=c[k];a?c[n]===undefined?c[n]=[v]:c[n].push(v):c[n]=v}else p[n]=v;return p},_context.register(Url,"Url")}),_context.invoke("Utils",function(Arrays,Strings,undefined){function map(args,callback){if(args=Arrays.createFrom(args),Arrays.isArray(args[0])){for(var i=0,elems=args[0],ret=[];i<elems.length;i++)args[0]=getElem(elems[i]),args[0]?ret.push(callback.apply(null,args)):ret.push(args[0]);return ret}return args[0]=getElem(args[0]),args[0]?callback.apply(null,args):args[0]}function getElem(elem){return(Arrays.isArray(elem)||elem instanceof HTMLCollection||elem instanceof NodeList)&&(elem=elem[0]),"string"==typeof elem?DOM.getById(elem):elem}function getPrefixed(elem,prop){if(Arrays.isArray(elem)&&(elem=elem[0]),prop in elem.style)return prop;var i,p=prop.charAt(0).toUpperCase()+prop.substr(1),variants=["webkit"+p,"moz"+p,"o"+p,"ms"+p];for(i=0;i<variants.length;i++)if(variants[i]in elem.style)return variants[i];return prop}function parseData(value){if(!value)return null;try{return JSON.parse(value)}catch(e){return value}}var DOM={getByClassName:function(className,context){return Arrays.createFrom((context||document).getElementsByClassName(className))},getById:function(id){return document.getElementById(id)},find:function(sel,context){var elems=[];return sel=sel.trim().split(/\s*,\s*/g),sel.forEach(function(s){var m=s.match(/^#([^\s\[>+:\.]+)\s+\.([^\s\[>+:]+)$/);if(m)return void elems.push.apply(elems,DOM.getByClassName(m[2],DOM.getById(m[1])));if(s.match(/^[^.#]|[\s\[>+:]/))throw new TypeError('Invalid selector "'+s+'", only single-level .class and #id or "#id .class" are allowed');"#"===s.charAt(0)?(m=DOM.getById(s.substr(1)),m&&elems.push(m)):(m=DOM.getByClassName(s.substr(1),context),elems.push.apply(elems,m))}),elems},getChildren:function(elem){return Arrays.createFrom(elem.childNodes||"").filter(function(node){return 1===node.nodeType})},closest:function(elem,nodeName,className){return map(arguments,function(elem,nodeName,className){for(;elem;){if(1===elem.nodeType&&(!nodeName||elem.nodeName.toLowerCase()===nodeName)&&(!className||DOM.hasClass(elem,className)))return elem;elem=elem.parentNode}return null})},create:function(elem,attrs){return elem=document.createElement(elem),attrs&&DOM.setAttributes(elem,attrs),elem},createFromHtml:function(html){var container=DOM.create("div");return DOM.html(container,html),html=DOM.getChildren(container),html.forEach(function(e){container.removeChild(e)}),container=null,html.length>1?html:html[0]},setAttributes:function(elem,attrs){return map([elem],function(elem){for(var a in attrs)attrs.hasOwnProperty(a)&&elem.setAttribute(a,attrs[a]);return elem})},setStyle:function(elem,prop,value,prefix){if(prop&&"object"==typeof prop){prefix=value,value=prop;for(prop in value)value.hasOwnProperty(prop)&&DOM.setStyle(elem,prop,value[prop],prefix);return elem}return prefix!==!1&&(prop=getPrefixed(elem,prop)),map([elem],function(elem){elem.style[prop]=value})},html:function(elem,html){return map([elem],function(elem){elem.innerHTML=html,Arrays.createFrom(elem.getElementsByTagName("script")).forEach(function(elem){if(!elem.type||"text/javascript"===elem.type.toLowerCase()){var load=elem.hasAttribute("src"),src=load?elem.src:elem.text||elem.textContent||elem.innerHTML||"",script=DOM.create("script",{type:"text/javascript"});if(load)script.src=src;else try{script.appendChild(document.createTextNode(src))}catch(e){script.text=src}elem.parentNode.insertBefore(script,elem),elem.parentNode.removeChild(elem)}})})},contains:function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))},addListener:function(elem,evt,listener){return map(arguments,function(elem,evt,listener){return elem.addEventListener(evt,listener,!1),elem})},removeListener:function(elem,evt,listener){return map(arguments,function(elem,evt,listener){return elem.removeEventListener(evt,listener,!1),elem})},getData:function(elem,key){return parseData(getElem(elem).getAttribute("data-"+key))},setData:function(elem,key,value){return map([elem],function(elem){return elem.setAttribute("data-"+key,JSON.stringify(value)),elem})},addClass:null,removeClass:null,toggleClass:null,hasClass:null},testElem=DOM.create("span"),prepare=function(args,asStr){return args=Arrays.createFrom(args,1).join(" ").trim(),asStr?args:args.split(/\s+/g)};"classList"in testElem?(testElem.classList.add("c1","c2"),testElem.classList.contains("c2")?(DOM.addClass=function(elem,classes){return classes=prepare(arguments),map([elem],function(elem){return elem.classList.add.apply(elem.classList,classes),elem})},DOM.removeClass=function(elem,classes){return classes=prepare(arguments),map([elem],function(elem){return elem.classList.remove.apply(elem.classList,classes),elem})}):(DOM.addClass=function(elem,classes){return classes=prepare(arguments),map([elem],function(elem){return classes.forEach(function(c){elem.classList.add(c)}),elem})},DOM.removeClass=function(elem,classes){return classes=prepare(arguments),map([elem],function(elem){return classes.forEach(function(c){elem.classList.remove(c)}),elem})}),testElem.classList.toggle("c1",!0),testElem.classList.contains("c1")?DOM.toggleClass=function(elem,classes,value){return classes=classes.trim().split(/\s+/g),map([elem],function(elem){return value===undefined?classes.forEach(function(c){elem.classList.toggle(c)}):classes.forEach(function(c){elem.classList.toggle(c,!!value)}),elem})}:DOM.toggleClass=function(elem,classes,value){return classes=classes.trim().split(/\s+/g),map([elem],function(elem){return classes.forEach(function(c){(value===undefined||value===elem.classList.contains(c))&&elem.classList.toggle(c)}),elem})},DOM.hasClass=function(elem,classes){elem=getElem(elem),classes=prepare(arguments);for(var i=0;i<classes.length;i++)if(!elem.classList.contains(classes[i]))return!1;return!0}):(DOM.addClass=function(elem,classes){return classes=prepare(arguments,!0),map([elem],function(elem){return elem.className+=(elem.className?" ":"")+classes,elem})},DOM.removeClass=function(elem,classes){return classes=prepare(arguments).map(Strings.escapeRegex),map([elem],function(elem){return elem.className?(elem.className=elem.className.replace(new RegExp("(?:^|s+)(?:"+classes.join("|")+"(?:s+|$)","g")," ").trim(),elem):elem})},DOM.toggleClass=function(elem,classes,value){return classes=classes.trim().split(/\s+/g),map([elem],function(elem){var current=(elem.className||"").trim().split(/\s+/g);return classes.forEach(function(c){var i=current.indexOf(c),has=i>-1;value===!1||has?value!==!0&&has&&current.splice(i,1):current.push(c)}),elem.className=current.join(" "),elem})},DOM.hasClass=function(elem,classes){if(elem=getElem(elem),!elem.className)return!1;classes=prepare(arguments);for(var current=elem.className.trim().split(/\s+/g),i=0;i<classes.length;i++)if(-1===current.indexOf(classes[i]))return!1;return!0}),testElem=null,_context.register(DOM,"DOM")}),_context.invoke("Utils",function(undefined){var ReflectionClass=function(c){this._={reflectedClass:"string"==typeof c?ReflectionClass.getClass(c):c}};ReflectionClass.from=function(c){return c instanceof ReflectionClass?c:new ReflectionClass(c)},ReflectionClass.getClass=function(name){return _context.lookup(name)},ReflectionClass.getClassName=function(obj,need){var className=_context.lookupClass(obj);if(className===!1&&need)throw new Error("Unknown class");return className},ReflectionClass.prototype.hasProperty=function(name){return this._.reflectedClass.prototype[name]!==undefined&&"function"!=typeof this._.reflectedClass.prototype[name]},ReflectionClass.prototype.hasMethod=function(name){return this._.reflectedClass.prototype[name]!==undefined&&"function"==typeof this._.reflectedClass.prototype[name]},ReflectionClass.prototype.newInstance=function(){return this.newInstanceArgs(arguments)},ReflectionClass.prototype.newInstanceArgs=function(args){var inst,ret,tmp=function(){};return tmp.prototype=this._.reflectedClass.prototype,inst=new tmp,ret=this._.reflectedClass.apply(inst,args),Object(ret)===ret?ret:inst},_context.register(ReflectionClass,"ReflectionClass")}),_context.invoke("Utils",function(Arrays,undefined){var ReflectionFunction=function(f){this._={reflectedFunction:f,argsList:f.length?f.toString().match(/^function\s*\(\s*(.*?)\s*\)/i)[1].split(/\s*,\s*/):[]}};ReflectionFunction.from=function(f){return f instanceof ReflectionFunction?f:new ReflectionFunction(f)},ReflectionFunction.prototype.invoke=function(context){var args=Arrays.createFrom(arguments);return args.shift(),this._.reflectedFunction.apply(context,args)},ReflectionFunction.prototype.getArgs=function(){return this._.argsList},ReflectionFunction.prototype.invokeArgs=function(context,args){for(var list=[],i=0;i<this._.argsList.length;i++){
if(args[this._.argsList[i]]===undefined)throw new Error('Parameter "'+this._.argsList[i]+'" was not provided in argument list');list.push(args[this._.argsList[i]])}return this._.reflectedFunction.apply(context,list)},_context.register(ReflectionFunction,"ReflectionFunction")}),_context.invoke("Nittro",function(){var prepare=function(self,need){if(!self._){if(need===!1)return!1;self._={}}if(!self._.eventEmitter){if(need===!1)return!1;self._.eventEmitter={listeners:{},defaultListeners:{},namespaces:[]}}},prepareNamespaces=function(emitter,namespaces){return namespaces.map(function(ns){var i=emitter.namespaces.indexOf(ns);return i>-1?i:(i=emitter.namespaces.length,emitter.namespaces.push(ns),i)})},hasCommonElement=function(a,b){for(var i=0,j=0;i<a.length&&j<b.length;)if(a[i]<b[j])i++;else{if(!(a[i]>b[j]))return!0;j++}return!1},process=function(emitter,evt,op,arg1,arg2){evt=(evt||"").replace(/^\s+|\s+$/g,"").split(/\s+/g),evt.forEach(function(e){var dflt=e.split(/:/),ns=dflt[0].split(/\./g);e=ns.shift(),ns=prepareNamespaces(emitter,ns),ns.sort(),op(emitter,e,ns,"default"===dflt[1],arg1,arg2)})},add=function(emitter,evt,ns,dflt,handler,mode){if(!evt)throw new TypeError("No event specified");if(dflt){if(0!==mode||ns.length)throw new TypeError("Default event handlers don't support namespaces and one()/first()");if(emitter.defaultListeners.hasOwnProperty(evt))throw new TypeError("Event '"+evt+"' already has a default listener");return void(emitter.defaultListeners[evt]=handler)}2===mode&&ns.unshift(emitter.namespaces.length),emitter.listeners[evt]||(emitter.listeners[evt]=[]),emitter.listeners[evt].push({handler:handler,namespaces:ns,mode:mode})},remove=function(emitter,evt,ns,dflt,handler){if(evt)return dflt?void(!emitter.defaultListeners.hasOwnProperty(evt)||handler&&emitter.defaultListeners[evt]!==handler||delete emitter.defaultListeners[evt]):void(emitter.listeners[evt]&&(ns.length?emitter.listeners[evt]=emitter.listeners[evt].filter(function(listener){return handler&&listener.handler!==handler?!0:!listener.namespaces.length||!hasCommonElement(listener.namespaces,ns)}):handler?emitter.listeners[evt]=emitter.listeners[evt].filter(function(listener){return listener.handler!==handler}):(emitter.listeners.hasOwnProperty(evt)&&delete emitter.listeners[evt],emitter.defaultListeners.hasOwnProperty(evt)&&delete emitter.defaultListeners[evt])));var listeners=dflt?emitter.defaultListeners:emitter.listeners;for(evt in listeners)listeners.hasOwnProperty(evt)&&remove(emitter,evt,ns,dflt,handler)},trigger=function(self,evt,data){var e,_=self._.eventEmitter;return"object"!=typeof evt&&(e=new NittroEvent(evt,data)),_.listeners.hasOwnProperty(evt)&&_.listeners[evt].slice().forEach(function(listener){1===listener.mode?remove(_,evt,[],!1,listener.handler):2===listener.mode&&remove(_,"",[listener.namespaces[0]],!1),listener.handler.call(self,e)}),!e.isDefaultPrevented()&&_.defaultListeners.hasOwnProperty(evt)&&_.defaultListeners[evt].call(self,e),e},NittroEventEmitter={on:function(evt,handler){return prepare(this),process(this._.eventEmitter,evt,add,handler,0),this},one:function(evt,handler){return prepare(this),process(this._.eventEmitter,evt,add,handler,1),this},first:function(evt,handler){return prepare(this),process(this._.eventEmitter,evt,add,handler,2),this._.eventEmitter.namespaces.push(null),this},off:function(evt,handler){return prepare(this,!1)===!1?this:(process(this._.eventEmitter,evt,remove,handler),this)},trigger:function(evt,data){return prepare(this,!1)===!1?this:trigger(this,evt,data)}},returnTrue=function(){return!0},returnFalse=function(){return!1},NittroEvent=_context.extend(function(type,data){this.type=type,this.data=data||{}},{preventDefault:function(){this.isDefaultPrevented=returnTrue},isDefaultPrevented:returnFalse});_context.register(NittroEventEmitter,"EventEmitter"),_context.register(NittroEvent,"Event")}),_context.invoke("Nittro",function(){var prepare=function(self,need){if(!self._){if(need===!1)return!1;self._={}}if(!self._.hasOwnProperty("frozen")){if(need===!1)return!1;self._.frozen=!1}},Freezable={freeze:function(){return prepare(this),this._.frozen=!0,this},isFrozen:function(){return prepare(this,!1)===!1?!1:this._.frozen},_updating:function(prop){if(prepare(this,!1)===!1)return this;if(this._.frozen){var className=_context.lookupClass(this)||"object";throw prop&&(prop=' "'+prop+'"'),new Error("Cannot update property"+prop+" of a frozen "+className)}return this}};_context.register(Freezable,"Freezable")}),_context.invoke("Nittro",function(){var Object=_context.extend(function(){this._={}},{});_context.mixin(Object,"Nittro.EventEmitter"),_context.register(Object,"Object")});